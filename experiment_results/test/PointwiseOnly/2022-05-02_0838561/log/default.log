2022-05-02 08:38:56,085 - INFO - Config:
2022-05-02 08:38:56,085 - INFO - {
    "L2_regularisation": 0,
    "alpha": 100,
    "base_dir": "models/experiments/final/eICU/LoS/PointwiseOnly",
    "batch_norm": "mybatchnorm",
    "batch_size": 512,
    "batch_size_test": 512,
    "batchnorm": "mybatchnorm",
    "dataset": "eICU",
    "diagnosis_size": 64,
    "disable_cuda": false,
    "exp_name": "PointwiseOnly",
    "intermediate_reporting": false,
    "kernel_size": 4,
    "labs_only": false,
    "last_linear_size": 17,
    "learning_rate": 0.00226,
    "loss": "msle",
    "main_dropout_rate": 0.45,
    "mode": "train",
    "model_type": "pointwise_only",
    "n_epochs": 15,
    "n_layers": 9,
    "name": "PointwiseOnly",
    "no_diag": false,
    "no_exp": false,
    "no_labs": false,
    "no_mask": false,
    "no_skip_connections": false,
    "no_temp_kernels": 12,
    "percentage_data": 100.0,
    "point_size": 13,
    "point_sizes": [
        13,
        13,
        13,
        13,
        13,
        13,
        13,
        13,
        13
    ],
    "save_results_csv": false,
    "seed": 121537415,
    "share_weights": false,
    "shuffle_train": true,
    "sum_losses": true,
    "task": "LoS",
    "temp_dropout_rate": 0.05,
    "temp_kernels": [
        12,
        12,
        12,
        12,
        12,
        12,
        12,
        12,
        12
    ]
}
2022-05-02 08:39:03,564 - INFO - Experiment set up.
2022-05-02 08:39:03,598 - INFO - TempPointConv(
  (relu): ReLU()
  (sigmoid): Sigmoid()
  (hardtanh): Hardtanh(min_val=0.020833333333333332, max_val=100)
  (msle_loss): MSLELoss(
    (squared_error): MSELoss()
  )
  (mse_loss): MSELoss(
    (squared_error): MSELoss()
  )
  (bce_loss): BCELoss()
  (main_dropout): Dropout(p=0.45, inplace=False)
  (temp_dropout): Dropout(p=0.05, inplace=False)
  (empty_module): EmptyModule()
  (diagnosis_encoder): Linear(in_features=293, out_features=64, bias=True)
  (bn_diagnosis_encoder): MyBatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_los): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_mort): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_final_los): Linear(in_features=17, out_features=1, bias=True)
  (point_final_mort): Linear(in_features=17, out_features=1, bias=True)
  (layer_modules): ModuleDict(
    (0): ModuleDict(
      (point): Linear(in_features=241, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (1): ModuleDict(
      (point): Linear(in_features=254, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ModuleDict(
      (point): Linear(in_features=267, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (3): ModuleDict(
      (point): Linear(in_features=280, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (4): ModuleDict(
      (point): Linear(in_features=293, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (5): ModuleDict(
      (point): Linear(in_features=306, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (6): ModuleDict(
      (point): Linear(in_features=319, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (7): ModuleDict(
      (point): Linear(in_features=332, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (8): ModuleDict(
      (point): Linear(in_features=345, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (point_last_los): Linear(in_features=422, out_features=17, bias=True)
  (point_last_mort): Linear(in_features=422, out_features=17, bias=True)
)
2022-05-02 08:39:03,600 - INFO - Loaded existing config from: ./experiment_results/train/PointwiseOnly/2022-05-01_1039241
2022-05-02 08:39:03,643 - INFO - Loaded existing checkpoint from: ./experiment_results/train/PointwiseOnly/2022-05-01_1039241\checkpoint\checkpoint_current.pth.tar
2022-05-02 08:44:19,145 - INFO - Custom bins confusion matrix:
2022-05-02 08:44:19,153 - INFO - [[284567 114738  19206   9162   4975   3023   1536    905   1065    104]
 [115704  88798  23472  13621   7932   4510   2579   1504   1931    136]
 [ 50475  54084  19889  13276   8671   5245   3003   1894   2141    148]
 [ 24720  33808  14599  11150   8073   5147   3186   1810   2597    138]
 [ 13335  21796  10687   8982   6939   4702   2909   1863   2723    198]
 [  7807  14220   8285   6883   5758   4125   2590   1706   2580    238]
 [  4879   9898   6281   5740   4807   3668   2307   1523   2193    249]
 [  3467   7128   4959   4720   4042   3052   2014   1277   2038    194]
 [  8141  19397  14881  15051  14131  10871   7671   5005   8474   1185]
 [  4051  10723   8779   8873   8365   7976   6457   4860   9818   1487]]
2022-05-02 08:44:21,536 - INFO - Test Loss: 94.7349
2022-05-02 08:44:21,576 - INFO - Testing ended. Results stored =)
