2022-05-03 07:27:57,588 - INFO - Config:
2022-05-03 07:27:57,589 - INFO - {
    "L2_regularisation": 0,
    "alpha": 100,
    "base_dir": "models/experiments/final/eICU/multitask/TPC",
    "batch_norm": "mybatchnorm",
    "batch_size": 24,
    "batch_size_test": 24,
    "batchnorm": "mybatchnorm",
    "dataset": "eICU",
    "diagnosis_size": 64,
    "disable_cuda": false,
    "exp_name": "TPC",
    "intermediate_reporting": false,
    "kernel_size": 4,
    "labs_only": false,
    "last_linear_size": 17,
    "learning_rate": 0.00226,
    "loss": "msle",
    "main_dropout_rate": 0.45,
    "mode": "train",
    "model_type": "tpc",
    "n_epochs": 15,
    "n_layers": 9,
    "name": "TPC",
    "no_diag": false,
    "no_exp": false,
    "no_labs": false,
    "no_mask": false,
    "no_skip_connections": false,
    "no_temp_kernels": 12,
    "percentage_data": 100.0,
    "point_size": 13,
    "point_sizes": [
        13,
        13,
        13,
        13,
        13,
        13,
        13,
        13,
        13
    ],
    "save_results_csv": false,
    "seed": 500027332,
    "share_weights": false,
    "shuffle_train": true,
    "sum_losses": true,
    "task": "multitask",
    "temp_dropout_rate": 0.05,
    "temp_kernels": [
        12,
        12,
        12,
        12,
        12,
        12,
        12,
        12,
        12
    ]
}
2022-05-03 07:28:04,539 - INFO - Experiment set up.
2022-05-03 07:28:07,978 - INFO - TempPointConv(
  (relu): ReLU()
  (sigmoid): Sigmoid()
  (hardtanh): Hardtanh(min_val=0.020833333333333332, max_val=100)
  (msle_loss): MSLELoss(
    (squared_error): MSELoss()
  )
  (mse_loss): MSELoss(
    (squared_error): MSELoss()
  )
  (bce_loss): BCELoss()
  (main_dropout): Dropout(p=0.45, inplace=False)
  (temp_dropout): Dropout(p=0.05, inplace=False)
  (empty_module): EmptyModule()
  (diagnosis_encoder): Linear(in_features=293, out_features=64, bias=True)
  (bn_diagnosis_encoder): MyBatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_los): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_mort): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_final_los): Linear(in_features=17, out_features=1, bias=True)
  (point_final_mort): Linear(in_features=17, out_features=1, bias=True)
  (layer_modules): ModuleDict(
    (0): ModuleDict(
      (temp): Conv1d(174, 1044, kernel_size=(4,), stride=(1,), groups=87)
      (bn_temp): MyBatchNorm1d(1044, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=241, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (1): ModuleDict(
      (temp): Conv1d(1300, 1200, kernel_size=(4,), stride=(1,), dilation=(3,), groups=100)
      (bn_temp): MyBatchNorm1d(1200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1298, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ModuleDict(
      (temp): Conv1d(1469, 1356, kernel_size=(4,), stride=(1,), dilation=(6,), groups=113)
      (bn_temp): MyBatchNorm1d(1356, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1454, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (3): ModuleDict(
      (temp): Conv1d(1638, 1512, kernel_size=(4,), stride=(1,), dilation=(9,), groups=126)
      (bn_temp): MyBatchNorm1d(1512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1610, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (4): ModuleDict(
      (temp): Conv1d(1807, 1668, kernel_size=(4,), stride=(1,), dilation=(12,), groups=139)
      (bn_temp): MyBatchNorm1d(1668, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1766, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (5): ModuleDict(
      (temp): Conv1d(1976, 1824, kernel_size=(4,), stride=(1,), dilation=(15,), groups=152)
      (bn_temp): MyBatchNorm1d(1824, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1922, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (6): ModuleDict(
      (temp): Conv1d(2145, 1980, kernel_size=(4,), stride=(1,), dilation=(18,), groups=165)
      (bn_temp): MyBatchNorm1d(1980, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2078, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (7): ModuleDict(
      (temp): Conv1d(2314, 2136, kernel_size=(4,), stride=(1,), dilation=(21,), groups=178)
      (bn_temp): MyBatchNorm1d(2136, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2234, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (8): ModuleDict(
      (temp): Conv1d(2483, 2292, kernel_size=(4,), stride=(1,), dilation=(24,), groups=191)
      (bn_temp): MyBatchNorm1d(2292, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2390, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (point_last_los): Linear(in_features=2781, out_features=17, bias=True)
  (point_last_mort): Linear(in_features=2781, out_features=17, bias=True)
)
2022-05-03 07:28:07,980 - INFO - Experiment started at 22-05-03_07:28:07.
2022-05-03 07:41:30,032 - INFO - Train Metrics:
2022-05-03 07:42:01,391 - INFO - Custom bins confusion matrix:
2022-05-03 07:42:01,391 - INFO - [[1326751  585227  118612   37941   15613    7471    3928    2303    3974
     1074]
 [ 413166  531048  172190   62662   26815   13114    6884    3895    7022
     1590]
 [ 119164  304733  175021   77072   35511   18467   10240    6171   10987
     2582]
 [  43789  154251  134182   74457   39400   21475   12689    7599   14561
     3603]
 [  20983   83065   91300   61435   36305   21743   13472    8828   17310
     4820]
 [  11326   49882   62034   47531   31188   19879   13188    8754   18674
     5599]
 [   6573   32520   43426   36412   25541   17144   11915    8398   18888
     6623]
 [   4159   21489   31387   28008   20679   14766   10365    7550   18375
     6963]
 [   9599   54821   82373   79984   65248   50032   37684   28341   76776
    36968]
 [   5187   26731   43846   47470   41728   33383   26165   20466   59352
    32500]]
2022-05-03 07:42:09,512 - INFO - Confusion matrix:
2022-05-03 07:42:09,513 - INFO - [[60092   126]
 [ 6467   227]]
2022-05-03 07:42:10,199 - INFO - Epoch: 0 | Train Loss: 83.7690
2022-05-03 07:43:51,863 - INFO - Validation Metrics:
2022-05-03 07:43:58,947 - INFO - Custom bins confusion matrix:
2022-05-03 07:43:58,948 - INFO - [[330459  94737  15606   4713   2043   1108    525    326    408      2]
 [ 59808 138385  41177  12850   5116   2551   1548    746   1050     11]
 [  7233  56860  50891  23174  10552   5557   2909   1742   2377     97]
 [  2245  17222  30224  22943  14026   8300   4637   2696   4174    320]
 [   752   5982  14118  16485  13178   8733   5813   3778   6280    423]
 [   599   3029   6902  10214   9579   8120   6049   4312   7757    587]
 [   421   1535   3398   5668   6453   5983   5506   4492   9185    819]
 [   267    952   2050   3485   4283   4241   4250   3891  10095   1111]
 [   666   2410   4063   6628   8985  10615  11742  11696  41922  12469]
 [   364   1136   1669   2696   3751   4851   5732   6583  30946  13960]]
2022-05-03 07:44:00,873 - INFO - Confusion matrix:
2022-05-03 07:44:00,873 - INFO - [[12962     2]
 [ 1319    28]]
2022-05-03 07:44:01,633 - INFO - Epoch: 0 | Validation Loss: 50.1620
2022-05-03 07:44:01,635 - INFO - Done epoch 0, spent 0:15:53.654995.
2022-05-03 07:57:33,950 - INFO - Train Metrics:
2022-05-03 07:58:07,013 - INFO - Custom bins confusion matrix:
2022-05-03 07:58:07,014 - INFO - [[1557428  445201   66741   19348    7129    3084    1573     877    1319
      194]
 [ 329435  639238  178177   52156   19426    8690    4484    2429    3731
      627]
 [  51947  292898  240280   94042   38237   17930    9429    5296    8477
     1428]
 [  14180   95706  170531  104407   52429   27227   15043    8814   14909
     2784]
 [   5911   36193   93999   82820   52262   30998   19033   11674   21827
     4559]
 [   3461   17580   52461   57275   42881   29086   19087   13172   26428
     6624]
 [   1973   10147   31304   38963   33062   24519   17684   12541   28402
     8845]
 [   1321    6340   19931   26711   24431   19472   15030   11523   28611
    10371]
 [   3850   13679   43463   64093   64935   57187   47842   39007  119087
    68683]
 [   2173    7429   21239   33252   36094   33799   29965   25371   85850
    61656]]
2022-05-03 07:58:14,968 - INFO - Confusion matrix:
2022-05-03 07:58:14,968 - INFO - [[59954   264]
 [ 6106   588]]
2022-05-03 07:58:15,743 - INFO - Epoch: 1 | Train Loss: 56.6871
2022-05-03 07:59:57,833 - INFO - Validation Metrics:
2022-05-03 08:00:04,878 - INFO - Custom bins confusion matrix:
2022-05-03 08:00:04,879 - INFO - [[342557  94399   9369   2367    796    258    134     43      4      0]
 [ 38470 175816  35663   8590   2896   1144    423    161     77      2]
 [  3022  66015  57981  21157   7864   3274   1338    424    317      0]
 [  1272  16762  37743  26325  13289   6358   2853   1327    858      0]
 [   646   5661  15976  21026  14847   8670   4615   2220   1870     11]
 [   550   2951   7428  12183  12574   9084   5957   3398   2975     48]
 [   301   1682   3666   6264   8250   8055   6276   4040   4825    101]
 [   266   1065   2296   3912   4590   5925   5409   4199   6728    235]
 [   677   2958   4761   6713   9175  11544  13039  14264  41058   7007]
 [   409   1338   2210   2877   4230   5952   7395   8175  30185   8917]]
2022-05-03 08:00:07,068 - INFO - Confusion matrix:
2022-05-03 08:00:07,068 - INFO - [[12923    41]
 [ 1177   170]]
2022-05-03 08:00:07,804 - INFO - Epoch: 1 | Validation Loss: 40.0851
2022-05-03 08:00:07,806 - INFO - Done epoch 1, spent 0:16:06.171430.
2022-05-03 08:13:28,888 - INFO - Train Metrics:
2022-05-03 08:14:02,275 - INFO - Custom bins confusion matrix:
2022-05-03 08:14:02,275 - INFO - [[1612428  416700   48980   13967    5323    2332    1272     659    1040
      183]
 [ 281355  714438  166575   43301   16180    7110    3702    1971    3239
      488]
 [  35384  295667  262376   93050   36109   16310    8159    4578    7161
     1127]
 [   9933   83041  179076  112516   54925   27476   14576    8465   13725
     2225]
 [   4681   28931   90659   87839   56133   33211   19988   12029   21607
     4126]
 [   2595   13268   47347   58158   45609   31677   21013   13924   27993
     6408]
 [   1679    7171   26820   37510   34009   26065   19452   13998   31470
     9218]
 [    978    4237   16270   24743   24652   20651   16096   12268   32152
    11653]
 [   2562    8963   33069   56123   61609   56851   49158   41375  131976
    80140]
 [   1725    5126   16172   27706   32070   31489   29097   25663   93537
    74243]]
2022-05-03 08:14:10,348 - INFO - Confusion matrix:
2022-05-03 08:14:10,349 - INFO - [[59943   276]
 [ 6053   639]]
2022-05-03 08:14:11,342 - INFO - Epoch: 2 | Train Loss: 49.2403
2022-05-03 08:15:53,406 - INFO - Validation Metrics:
2022-05-03 08:16:00,406 - INFO - Custom bins confusion matrix:
2022-05-03 08:16:00,407 - INFO - [[369864  68956   7340   2390    842    328    122     49     32      4]
 [ 38818 170793  38364   9258   3435   1543    559    294    176      2]
 [  2395  50795  66292  25493   9163   4116   1826    762    550      0]
 [   778  10356  32098  31881  16812   7673   3808   1909   1467      5]
 [   387   2983  10459  19712  18522  11109   6139   3044   3134     53]
 [   249   1348   4445   9473  12524  11495   7581   4783   5124    126]
 [    97    755   2304   4257   6856   8220   7159   5382   8229    201]
 [    94    452   1204   2553   3682   5194   5633   4951  10386    476]
 [   312    993   2385   3882   6108   8380  11083  12972  54204  10877]
 [   201    499    877   1693   2481   3278   4003   5377  38443  14836]]
2022-05-03 08:16:02,521 - INFO - Confusion matrix:
2022-05-03 08:16:02,521 - INFO - [[12944    20]
 [ 1228   119]]
2022-05-03 08:16:03,367 - INFO - Epoch: 2 | Validation Loss: 31.9800
2022-05-03 08:16:03,370 - INFO - Done epoch 2, spent 0:15:55.563494.
2022-05-03 08:29:24,925 - INFO - Train Metrics:
2022-05-03 08:29:57,792 - INFO - Custom bins confusion matrix:
2022-05-03 08:29:57,792 - INFO - [[1651260  392041   39089   11428    4411    1996    1084     588     842
      142]
 [ 252355  759949  159578   38519   13795    6218    3240    1719    2588
      413]
 [  25731  292861  279644   94187   34095   14926    7203    4147    6201
      950]
 [   7227   71202  185532  120925   56856   27393   14128    8062   12658
     2011]
 [   3142   22913   87220   92899   60306   35308   20579   12324   20861
     3700]
 [   1877   10021   43178   58961   48491   33752   22187   14671   28698
     6195]
 [   1057    5449   24067   37246   34788   27478   20274   14552   33507
     8998]
 [    637    3301   14442   23485   24553   21009   16853   13109   34187
    12141]
 [   1753    6772   28399   52147   58141   56310   48756   42154  140456
    86917]
 [    986    3609   13178   24085   28732   29832   27772   25558   97854
    85222]]
2022-05-03 08:30:05,836 - INFO - Confusion matrix:
2022-05-03 08:30:05,836 - INFO - [[59923   294]
 [ 5951   743]]
2022-05-03 08:30:06,672 - INFO - Epoch: 3 | Train Loss: 44.4703
2022-05-03 08:31:49,188 - INFO - Validation Metrics:
2022-05-03 08:31:56,191 - INFO - Custom bins confusion matrix:
2022-05-03 08:31:56,191 - INFO - [[386902  54423   5100   1631    770    367    229    188    314      3]
 [ 41876 183416  26863   5687   2306   1118    642    398    852     84]
 [  2149  65402  63426  17501   5871   2752   1526    936   1711    118]
 [   724  12248  39404  29481  11739   5230   2880   1708   3016    357]
 [   299   3265  13740  21771  15663   8069   4374   2777   5057    527]
 [   210   1357   5558  10891  12217   9406   5679   3964   7039    827]
 [   129    762   2211   4998   7149   7161   5960   4434   9420   1236]
 [   121    427   1141   2809   3649   4591   4725   4152  11353   1657]
 [   171    673   1859   3743   5731   7175   8821  10145  51870  21008]
 [   101    286    520    843   1504   2247   3313   4124  31528  27222]]
2022-05-03 08:31:58,398 - INFO - Confusion matrix:
2022-05-03 08:31:58,398 - INFO - [[12933    31]
 [ 1186   161]]
2022-05-03 08:31:59,162 - INFO - Epoch: 3 | Validation Loss: 29.4219
2022-05-03 08:31:59,164 - INFO - Done epoch 3, spent 0:15:55.794407.
2022-05-03 08:45:22,324 - INFO - Train Metrics:
2022-05-03 08:45:55,335 - INFO - Custom bins confusion matrix:
2022-05-03 08:45:55,335 - INFO - [[1675275  376166   33383   10047    3944    1797     914     525     751
      108]
 [ 232779  793862  151127   35473   12570    5554    2829    1472    2365
      369]
 [  20089  290883  290033   94540   32626   14201    6882    3792    5928
      971]
 [   5346   63831  189255  125943   58205   27667   13992    7741   12101
     1901]
 [   2380   19188   86068   95688   62202   36053   20812   12455   20765
     3641]
 [   1213    8322   40916   59666   50254   34911   22898   15129   28553
     6193]
 [    703    4584   22210   36464   35756   28533   21154   15074   34012
     8950]
 [    501    2595   13130   22986   24728   21773   17483   13506   34933
    12106]
 [   1188    5527   25541   48632   56654   55679   49687   42998  144304
    91616]
 [    784    3055   11593   22469   27121   29511   27736   25340  100004
    89215]]
2022-05-03 08:46:03,605 - INFO - Confusion matrix:
2022-05-03 08:46:03,606 - INFO - [[59887   331]
 [ 5895   799]]
2022-05-03 08:46:04,653 - INFO - Epoch: 4 | Train Loss: 41.6446
2022-05-03 08:47:49,386 - INFO - Validation Metrics:
2022-05-03 08:47:56,620 - INFO - Custom bins confusion matrix:
2022-05-03 08:47:56,621 - INFO - [[382658  59286   4924   1705    700    332    132     97     90      3]
 [ 32652 182167  35944   7256   2673   1286    582    301    374      7]
 [  2089  48150  73102  23769   7236   3292   1829    904    997     24]
 [   713   8247  33347  34732  15492   6311   3256   2063   2549     77]
 [   312   2493   9766  19896  19014  10247   5484   3189   4973    168]
 [   218   1180   4085   8922  11872  11153   7226   4662   7483    347]
 [   150    693   1671   3970   5733   7681   7245   4953  10657    707]
 [    82    376   1005   2092   3079   4229   5095   4681  12603   1383]
 [   122    601   1611   2918   4620   6323   7694   9163  56897  21247]
 [    54    250    402    818   1469   1936   2627   3211  31609  29312]]
2022-05-03 08:47:58,764 - INFO - Confusion matrix:
2022-05-03 08:47:58,764 - INFO - [[12839   125]
 [ 1064   283]]
2022-05-03 08:47:59,647 - INFO - Epoch: 4 | Validation Loss: 27.3240
2022-05-03 08:47:59,648 - INFO - Done epoch 4, spent 0:16:00.483970.
2022-05-03 09:01:25,549 - INFO - Train Metrics:
2022-05-03 09:01:59,328 - INFO - Custom bins confusion matrix:
2022-05-03 09:01:59,328 - INFO - [[1695559  363820   28390    8514    3324    1425     726     422     598
      110]
 [ 215736  823413  144346   32307   11395    4865    2508    1408    2048
      341]
 [  15980  286768  299837   95482   32259   13333    6504    3553    5367
      866]
 [   4138   56017  190552  132450   60532   27556   13795    7566   11543
     1857]
 [   1869   16196   82431   98554   65438   37407   21260   12361   20186
     3550]
 [    968    6988   38360   60042   51090   36304   23678   15586   29071
     5944]
 [    577    3710   20443   36006   36034   29107   21730   15569   35286
     8954]
 [    360    2250   11855   22181   24892   21820   18028   13797   36471
    12074]
 [    810    4496   23419   45904   55480   55183   50077   43735  147742
    94980]
 [    523    2420   10528   20938   25348   28295   26913   24716  101345
    95802]]
2022-05-03 09:02:07,670 - INFO - Confusion matrix:
2022-05-03 09:02:07,670 - INFO - [[59903   316]
 [ 5852   840]]
2022-05-03 09:02:08,475 - INFO - Epoch: 5 | Train Loss: 39.0919
2022-05-03 09:03:52,261 - INFO - Validation Metrics:
2022-05-03 09:03:59,394 - INFO - Custom bins confusion matrix:
2022-05-03 09:03:59,395 - INFO - [[396562  48105   3446   1202    362    167     41     29     13      0]
 [ 34551 195675  26025   4339   1623    725    190     69     45      0]
 [  1366  58249  76848  17176   4699   1750    816    301    187      0]
 [   448   7952  45146  34694  11184   4200   1778    814    571      0]
 [   152   2050  13001  29022  17757   7088   3475   1437   1544     16]
 [   123    849   4200  14812  16989  10139   5023   2454   2504     55]
 [    54    443   1566   6074  10779  10180   6607   3538   4165     54]
 [    61    251    926   2746   5446   7904   6652   4385   6147    107]
 [    74    503   1607   4164   7336  11347  15262  15499  48568   6836]
 [    37    203    655   1384   2456   3931   5662   6850  36724  13786]]
2022-05-03 09:04:01,487 - INFO - Confusion matrix:
2022-05-03 09:04:01,488 - INFO - [[12856   108]
 [ 1084   263]]
2022-05-03 09:04:02,440 - INFO - Epoch: 5 | Validation Loss: 24.6901
2022-05-03 09:04:02,441 - INFO - Done epoch 5, spent 0:16:02.793301.
2022-05-03 09:17:16,679 - INFO - Train Metrics:
2022-05-03 09:17:50,386 - INFO - Custom bins confusion matrix:
2022-05-03 09:17:50,387 - INFO - [[1709318  355289   24679    7610    2923    1324     653     415     598
       86]
 [ 202387  848085  137997   29400   10285    4513    2270    1236    1947
      282]
 [  13570  284434  306640   95551   31449   12843    6245    3297    5134
      782]
 [   3374   51247  191500  135842   62175   27769   13651    7405   11233
     1786]
 [   1471   14358   80738   99321   67369   38169   21897   12378   20081
     3463]
 [    817    5944   37030   59414   51882   36847   24492   15868   29698
     6063]
 [    495    3063   19307   35337   36221   29633   22366   16002   36032
     8984]
 [    293    1877   11153   21657   24477   22198   18343   14218   37273
    12252]
 [    659    3621   21390   44082   53835   55083   50290   44167  151531
    97168]
 [    440    2007    9626   20362   24745   27798   26484   25042  102418
    97906]]
2022-05-03 09:17:58,445 - INFO - Confusion matrix:
2022-05-03 09:17:58,446 - INFO - [[59864   354]
 [ 5814   880]]
2022-05-03 09:17:59,402 - INFO - Epoch: 6 | Train Loss: 37.2911
2022-05-03 09:19:42,404 - INFO - Validation Metrics:
2022-05-03 09:19:49,509 - INFO - Custom bins confusion matrix:
2022-05-03 09:19:49,510 - INFO - [[397072  46498   3884   1483    600    280     74     23     13      0]
 [ 30283 191319  33078   4916   2036    961    439    146     62      2]
 [   996  40912  87131  21887   5863   2548   1147    533    375      0]
 [   305   3487  38479  40804  13522   5347   2378   1359   1105      1]
 [   182   1003   9067  28243  20179   8076   4061   2192   2532      7]
 [   109    525   2458  12390  18055  11109   5303   3089   4079     31]
 [    41    252    999   4578  10190  10641   6798   3789   6034    138]
 [    25    124    547   2072   5047   7019   6858   4695   8086    152]
 [    59    235    952   3071   6338   9426  12332  14715  57305   6763]
 [    29    102    357    699   1578   2850   4684   5875  42816  12698]]
2022-05-03 09:19:51,565 - INFO - Confusion matrix:
2022-05-03 09:19:51,566 - INFO - [[12888    76]
 [ 1094   253]]
2022-05-03 09:19:52,363 - INFO - Epoch: 6 | Validation Loss: 23.5249
2022-05-03 09:19:52,365 - INFO - Done epoch 6, spent 0:15:49.923704.
2022-05-03 09:33:03,061 - INFO - Train Metrics:
2022-05-03 09:33:37,117 - INFO - Custom bins confusion matrix:
2022-05-03 09:33:37,118 - INFO - [[1717054  350916   22327    7004    2762    1273     615     345     507
       95]
 [ 193531  864336  133696   27631    9513    4361    2056    1113    1841
      305]
 [  11698  280652  313840   96201   30802   12282    5800    3174    4744
      752]
 [   2984   46832  191170  139537   63455   28548   13572    7326   10902
     1656]
 [   1227   12555   78448  101321   68367   39563   21800   12498   20096
     3353]
 [    742    5407   35571   59310   53557   37423   24715   16080   29457
     5745]
 [    457    2880   18820   35100   36546   30098   22481   16355   35638
     9042]
 [    208    1784   11273   21534   24523   22381   17826   14347   37448
    12417]
 [    552    3651   20522   43170   53332   54347   50129   44558  152927
    98638]
 [    383    1768    8808   19205   23749   27787   26625   24809  103710
    99984]]
2022-05-03 09:33:45,475 - INFO - Confusion matrix:
2022-05-03 09:33:45,476 - INFO - [[59836   381]
 [ 5749   945]]
2022-05-03 09:33:46,309 - INFO - Epoch: 7 | Train Loss: 36.0653
2022-05-03 09:35:28,893 - INFO - Validation Metrics:
2022-05-03 09:35:36,072 - INFO - Custom bins confusion matrix:
2022-05-03 09:35:36,072 - INFO - [[400845  43531   3277   1276    545    319     83     16     35      0]
 [ 27347 198143  29399   4549   2008   1053    430    190    123      0]
 [   981  44161  86544  19952   4764   2456   1398    678    455      3]
 [   375   3689  38114  41960  12755   4392   2565   1508   1429      0]
 [   183   1047   8125  28517  20765   7669   3859   2356   3004     17]
 [   107    507   2648  11842  17735  11244   5232   2993   4791     49]
 [    53    263   1051   4361   9804  10217   7188   3651   6790     82]
 [    69    168    456   1989   4614   6824   6946   4736   8715    108]
 [   123    254    792   2635   5513   8816  12172  14607  60018   6266]
 [    28    108    175    528   1094   2125   3770   5692  44107  14061]]
2022-05-03 09:35:38,122 - INFO - Confusion matrix:
2022-05-03 09:35:38,122 - INFO - [[12883    81]
 [ 1091   256]]
2022-05-03 09:35:39,046 - INFO - Epoch: 7 | Validation Loss: 22.7341
2022-05-03 09:35:39,048 - INFO - Done epoch 7, spent 0:15:46.683346.
2022-05-03 09:48:44,780 - INFO - Train Metrics:
2022-05-03 09:49:18,394 - INFO - Custom bins confusion matrix:
2022-05-03 09:49:18,395 - INFO - [[1724715  345726   20761    6503    2496    1218     605     311     507
       50]
 [ 184642  881725  128164   25952    8830    3959    1997    1063    1751
      285]
 [  10527  279847  318662   95117   29678   12056    5672    3036    4662
      732]
 [   2595   44209  192415  142056   63716   28381   13482    7148   10384
     1644]
 [   1129   11031   76947  102267   69990   40151   22061   12743   19871
     3086]
 [    585    4952   34378   59576   53449   38428   25150   16323   29574
     5640]
 [    347    2673   18211   34692   36494   30413   22792   16636   36526
     8656]
 [    176    1457   10557   20966   24443   22238   18535   14346   38600
    12423]
 [    528    3446   19801   42036   52715   54328   49718   44752  154718
    99784]
 [    297    1517    8316   18699   23261   26933   26132   24295  102799
   104579]]
2022-05-03 09:49:26,382 - INFO - Confusion matrix:
2022-05-03 09:49:26,383 - INFO - [[59845   372]
 [ 5777   917]]
2022-05-03 09:49:27,208 - INFO - Epoch: 8 | Train Loss: 34.9814
2022-05-03 09:51:09,608 - INFO - Validation Metrics:
2022-05-03 09:51:16,731 - INFO - Custom bins confusion matrix:
2022-05-03 09:51:16,732 - INFO - [[402067  42840   3195   1282    406     95     20     16      6      0]
 [ 28264 199997  28463   4189   1511    592    175     37     14      0]
 [   815  42917  90389  20271   4457   1549    638    268     88      0]
 [   237   3016  41121  43560  12359   3898   1515    742    339      0]
 [   103    759   8567  33141  20554   6966   3006   1512    934      0]
 [    63    458   2689  14292  20163  10509   4531   2523   1920      0]
 [    42    241   1003   5398  11629  11668   6454   3560   3465      0]
 [    23    137    614   2623   5790   8177   7435   4551   5268      7]
 [    70    280   1351   4250   7785  12197  15659  17568  48940   3096]
 [    18    150    583   1460   2407   3597   5534   7856  41213   8870]]
2022-05-03 09:51:18,955 - INFO - Confusion matrix:
2022-05-03 09:51:18,955 - INFO - [[12914    50]
 [ 1112   235]]
2022-05-03 09:51:19,772 - INFO - Epoch: 8 | Validation Loss: 22.4493
2022-05-03 09:51:19,774 - INFO - Done epoch 8, spent 0:15:40.725941.
2022-05-03 10:04:27,345 - INFO - Train Metrics:
2022-05-03 10:05:00,420 - INFO - Custom bins confusion matrix:
2022-05-03 10:05:00,420 - INFO - [[1731965  341713   18663    5801    2357    1020     545     296     461
       80]
 [ 180271  893322  124377   24013    8236    3619    1747    1044    1542
      246]
 [   9758  276658  325155   94825   29158   11519    5317    2842    4132
      629]
 [   2305   40583  192717  144860   65056   28429   13369    7060   10148
     1503]
 [   1077   10250   74236  103443   71735   40500   22415   12923   19605
     3092]
 [    490    4241   32293   59471   54650   39073   25698   16510   30025
     5604]
 [    313    2355   17011   34289   37022   30822   23282   16869   36598
     8879]
 [    162    1377    9949   20614   24433   22592   18936   14595   38724
    12359]
 [    540    3038   18188   40846   51458   54424   49574   44359  157668
   101731]
 [    255    1461    8241   18373   22804   26549   25562   24394  103802
   105387]]
2022-05-03 10:05:08,610 - INFO - Confusion matrix:
2022-05-03 10:05:08,610 - INFO - [[59859   360]
 [ 5797   897]]
2022-05-03 10:05:09,504 - INFO - Epoch: 9 | Train Loss: 34.0854
2022-05-03 10:06:52,869 - INFO - Validation Metrics:
2022-05-03 10:07:00,134 - INFO - Custom bins confusion matrix:
2022-05-03 10:07:00,134 - INFO - [[400232  45012   2596    986    541    326    141     48     45      0]
 [ 28352 198415  27761   4717   1709    971    622    366    324      5]
 [  1219  40853  84485  23166   5940   2457   1245    757   1224     46]
 [   383   3327  31974  43506  15357   5348   2830   1537   2392    133]
 [   141    977   6079  25377  21935   9372   4476   2548   4419    218]
 [   125    512   2098   9231  16256  12180   6307   3659   6290    490]
 [    59    236    777   3043   8124   9494   7578   4659   8718    772]
 [    19    133    441   1508   3544   5944   5832   4867  11267   1070]
 [    48    238    692   1929   3920   6859   9596  11354  59054  17506]
 [    15    122    191    440    857   1384   2586   3808  35370  26915]]
2022-05-03 10:07:02,188 - INFO - Confusion matrix:
2022-05-03 10:07:02,188 - INFO - [[12846   118]
 [ 1038   309]]
2022-05-03 10:07:03,080 - INFO - Epoch: 9 | Validation Loss: 21.2503
2022-05-03 10:07:03,081 - INFO - Done epoch 9, spent 0:15:43.307291.
2022-05-03 10:20:11,297 - INFO - Train Metrics:
2022-05-03 10:20:45,544 - INFO - Custom bins confusion matrix:
2022-05-03 10:20:45,544 - INFO - [[1737324  338087   17649    5453    2104     960     508     295     456
       78]
 [ 174503  903604  121195   23267    7949    3389    1725     996    1561
      237]
 [   8957  275676  328188   94136   28960   11216    5274    2745    4195
      646]
 [   2009   38638  192993  145942   65752   28815   13440    7056    9859
     1526]
 [    897    9779   74179  103580   72182   40837   22364   12754   19587
     3117]
 [    478    4204   31702   59642   54495   39331   26249   16867   29509
     5578]
 [    274    2349   17031   34036   36823   31162   23349   16890   36818
     8708]
 [    160    1253    9865   20493   24225   22743   18815   14951   38774
    12462]
 [    452    2773   17939   40154   51701   54148   49888   45032  157657
   102082]
 [    219    1391    7732   17538   21698   26008   25073   23779  104762
   108628]]
2022-05-03 10:20:53,770 - INFO - Confusion matrix:
2022-05-03 10:20:53,770 - INFO - [[59858   361]
 [ 5795   899]]
2022-05-03 10:20:54,552 - INFO - Epoch: 10 | Train Loss: 33.2748
2022-05-03 10:22:38,585 - INFO - Validation Metrics:
2022-05-03 10:22:45,688 - INFO - Custom bins confusion matrix:
2022-05-03 10:22:45,688 - INFO - [[405533  41092   2010    808    322     90     63      8      1      0]
 [ 28434 207585  22107   3271   1112    474    207     38     14      0]
 [  1541  48707  85895  18609   4255   1425    588    244    128      0]
 [   579   4205  37478  44728  12874   4155   1599    662    507      0]
 [   243   1260   7225  28981  23175   8191   3499   1651   1316      1]
 [   206    750   2146  10985  19374  12486   5446   2904   2833     18]
 [    75    303    788   3918   9994  11608   7747   4074   4901     52]
 [    32    205    611   1683   4629   7232   7502   5235   7402     94]
 [    89    363   1262   3038   5753   9391  13417  15810  56333   5740]
 [    39    162    523   1070   1921   2749   4487   6479  41005  13253]]
2022-05-03 10:22:47,910 - INFO - Confusion matrix:
2022-05-03 10:22:47,911 - INFO - [[12881    83]
 [ 1067   280]]
2022-05-03 10:22:48,677 - INFO - Epoch: 10 | Validation Loss: 20.7504
2022-05-03 10:22:48,679 - INFO - Done epoch 10, spent 0:15:45.597112.
2022-05-03 10:35:57,361 - INFO - Train Metrics:
2022-05-03 10:36:30,901 - INFO - Custom bins confusion matrix:
2022-05-03 10:36:30,902 - INFO - [[1740330  336667   16630    5097    2005     932     469     276     422
       76]
 [ 168788  914477  118630   21774    7375    3199    1661     910    1342
      228]
 [   8303  273684  333585   93409   28010   10737    4964    2628    4004
      645]
 [   2072   36684  193446  147944   66124   28693   13121    6762    9723
     1437]
 [    866    8942   72204  104415   73075   41579   22994   12908   19340
     2929]
 [    404    3735   30960   58902   54988   40079   26450   16892   30280
     5341]
 [    249    1983   16200   33692   37143   31309   23877   17202   36999
     8763]
 [    146    1239    9476   20131   24245   22930   18721   14947   39622
    12284]
 [    386    2618   17715   39510   50608   53838   50117   44981  158945
   103108]
 [    290    1396    7593   17315   20997   25778   25012   24207  104932
   109308]]
2022-05-03 10:36:38,916 - INFO - Confusion matrix:
2022-05-03 10:36:38,916 - INFO - [[59830   389]
 [ 5757   936]]
2022-05-03 10:36:39,845 - INFO - Epoch: 11 | Train Loss: 32.7437
2022-05-03 10:38:20,906 - INFO - Validation Metrics:
2022-05-03 10:38:27,906 - INFO - Custom bins confusion matrix:
2022-05-03 10:38:27,906 - INFO - [[389055  57003   2376    940    390    128     23      9      3      0]
 [ 15617 216724  25010   3698   1444    479    183     63     24      0]
 [   715  42723  91625  19429   4308   1681    573    206    132      0]
 [   309   2824  39444  45228  12408   3956   1660    628    330      0]
 [   160    957   7259  32865  21536   7180   3296   1478    811      0]
 [   117    497   1911  12713  22065  10688   4769   2688   1698      2]
 [    39    210    710   4221  12431  12706   5933   3745   3459      6]
 [    20    106    445   1828   5412   9471   7394   4412   5533      4]
 [    67    297    993   2899   6358  11301  16298  18193  51770   3020]
 [    26    128    371    788   1754   3068   5262   7758  44058   8475]]
2022-05-03 10:38:29,956 - INFO - Confusion matrix:
2022-05-03 10:38:29,956 - INFO - [[12872    92]
 [ 1070   277]]
2022-05-03 10:38:30,710 - INFO - Epoch: 11 | Validation Loss: 20.6515
2022-05-03 10:38:30,711 - INFO - Done epoch 11, spent 0:15:42.032872.
2022-05-03 10:51:38,965 - INFO - Train Metrics:
2022-05-03 10:52:12,731 - INFO - Custom bins confusion matrix:
2022-05-03 10:52:12,731 - INFO - [[1744586  333985   15566    4709    1900     922     455     260     448
       85]
 [ 163620  923857  115984   20710    7022    3144    1569     894    1363
      263]
 [   7472  269434  339196   93766   27502   10455    5006    2582    3889
      688]
 [   1804   34811  192787  150009   66811   28756   13059    6857    9613
     1523]
 [    761    8664   71606  104491   73478   41964   23045   12903   19460
     2904]
 [    419    3772   30689   59077   55481   40035   26234   16942   30036
     5370]
 [    248    2165   16113   33525   37407   31180   23800   17143   37177
     8682]
 [    119    1296    9529   20114   24160   22811   19121   15031   39232
    12328]
 [    282    2268   17179   39286   50470   53849   50126   45213  159895
   103141]
 [    253    1185    7174   16718   20796   25460   24626   23875  104998
   111530]]
2022-05-03 10:52:20,922 - INFO - Confusion matrix:
2022-05-03 10:52:20,922 - INFO - [[59873   345]
 [ 5750   944]]
2022-05-03 10:52:21,741 - INFO - Epoch: 12 | Train Loss: 32.1062
2022-05-03 10:54:04,522 - INFO - Validation Metrics:
2022-05-03 10:54:11,598 - INFO - Custom bins confusion matrix:
2022-05-03 10:54:11,599 - INFO - [[406784  39466   2369    802    278    135     51     14     28      0]
 [ 23509 213269  21712   2887   1037    432    255     88     53      0]
 [   562  47733  89726  16833   3672   1434    731    430    271      0]
 [   202   2722  40907  42760  12850   3829   1745    927    845      0]
 [   103    621   7748  30705  21807   7878   3335   1758   1576     11]
 [    68    334   2152  12027  19633  11940   5220   2891   2830     53]
 [    38    204    806   4010  10581  11764   7110   3739   5128     80]
 [    25    127    517   1699   4924   7354   7746   4834   7323     76]
 [    95    308   1174   2765   6072   9102  13049  14820  57324   6487]
 [    32    164    339    933   1654   2842   4050   5993  41030  14651]]
2022-05-03 10:54:13,650 - INFO - Confusion matrix:
2022-05-03 10:54:13,651 - INFO - [[12914    50]
 [ 1140   207]]
2022-05-03 10:54:14,629 - INFO - Epoch: 12 | Validation Loss: 20.6471
2022-05-03 10:54:14,631 - INFO - Done epoch 12, spent 0:15:43.919258.
2022-05-03 11:07:25,674 - INFO - Train Metrics:
2022-05-03 11:07:59,145 - INFO - Custom bins confusion matrix:
2022-05-03 11:07:59,146 - INFO - [[1747019  333077   14424    4497    1898     814     455     240     396
       79]
 [ 162101  927681  114890   19932    6813    2953    1559     857    1378
      236]
 [   7186  267170  344264   92749   26911   10128    4652    2513    3802
      618]
 [   1574   32840  193795  151656   67194   28501   13053    6638    9392
     1387]
 [    678    7835   70141  105827   74941   42341   23011   12664   18950
     2888]
 [    400    3428   30158   58370   56170   40533   26664   17233   29857
     5242]
 [    245    2076   15784   33181   36945   31665   24086   17441   37422
     8595]
 [    133    1318    9132   19639   23834   23169   19133   15290   39946
    12147]
 [    317    2506   16992   38570   50200   53460   49965   45217  160136
   104463]
 [    186    1192    7041   16477   20509   25019   24641   23530  105428
   112805]]
2022-05-03 11:08:07,426 - INFO - Confusion matrix:
2022-05-03 11:08:07,427 - INFO - [[59861   357]
 [ 5743   951]]
2022-05-03 11:08:08,239 - INFO - Epoch: 13 | Train Loss: 31.6127
2022-05-03 11:09:52,492 - INFO - Validation Metrics:
2022-05-03 11:09:59,741 - INFO - Custom bins confusion matrix:
2022-05-03 11:09:59,741 - INFO - [[397696  48531   2172    832    354    170     96     33     43      0]
 [ 18460 214451  24456   3325   1296    646    301    154    153      0]
 [   558  41340  91533  19789   4740   1740    865    405    416      6]
 [   211   2243  35336  44864  15304   4842   2006    993    980      8]
 [    89    535   5840  26891  24724   9676   3673   1726   2356     32]
 [    47    261   1524   9223  18993  14197   5890   2950   3960    103]
 [    17    161    500   2734   8931  12267   8380   4071   6205    194]
 [    27     92    357   1075   3712   6810   7762   5607   8862    321]
 [    85    213    738   1884   4282   7215  10675  13221  61209  11674]
 [    10     86    318    738   1156   2026   3084   3987  38573  21710]]
2022-05-03 11:10:01,926 - INFO - Confusion matrix:
2022-05-03 11:10:01,926 - INFO - [[12873    91]
 [ 1085   262]]
2022-05-03 11:10:02,719 - INFO - Epoch: 13 | Validation Loss: 19.2487
2022-05-03 11:10:02,721 - INFO - Done epoch 13, spent 0:15:48.090763.
2022-05-03 11:23:12,309 - INFO - Train Metrics:
2022-05-03 11:23:46,017 - INFO - Custom bins confusion matrix:
2022-05-03 11:23:46,018 - INFO - [[1749259  331349   13952    4394    1882     866     467     247     412
       66]
 [ 158280  933731  113948   19192    6457    2862    1518     903    1251
      245]
 [   7040  266920  344513   93157   27102    9974    4631    2392    3647
      593]
 [   1620   32956  193216  152557   67511   28249   13121    6335    9070
     1371]
 [    789    8005   70312  104600   75073   42612   23132   12976   18969
     2784]
 [    357    3448   30006   58297   55520   41000   26662   17124   30278
     5339]
 [    239    1912   15686   33518   37034   31608   23902   17426   37643
     8448]
 [    183    1244    9133   19872   24276   23029   19220   15224   39326
    12210]
 [    313    2247   16732   38182   49946   53540   50040   45120  160975
   104679]
 [    230    1169    7053   16309   20197   24894   24592   23312  104379
   114693]]
2022-05-03 11:23:54,276 - INFO - Confusion matrix:
2022-05-03 11:23:54,276 - INFO - [[59835   382]
 [ 5673  1021]]
2022-05-03 11:23:55,302 - INFO - Epoch: 14 | Train Loss: 31.2767
2022-05-03 11:25:39,259 - INFO - Validation Metrics:
2022-05-03 11:25:46,401 - INFO - Custom bins confusion matrix:
2022-05-03 11:25:46,402 - INFO - [[401520  45430   1914    640    196    111     75     16     25      0]
 [ 21623 212696  24098   2973   1036    448    198     98     72      0]
 [   933  40919  91486  21201   4069   1558    622    361    243      0]
 [   306   3102  34057  46539  15465   4257   1630    760    670      1]
 [   119    908   5756  27737  24444  10177   3533   1426   1422     20]
 [    99    567   1687   9396  19176  14027   6596   2814   2744     42]
 [    71    260    812   3100   8761  12558   8364   4521   4958     55]
 [    39    260    567   1589   3802   6791   7783   5804   7903     87]
 [    95    481   1428   3066   5466   8109  10931  14026  58920   8674]
 [    73    170    589   1276   1810   2565   3838   5089  38579  17699]]
2022-05-03 11:25:48,480 - INFO - Confusion matrix:
2022-05-03 11:25:48,480 - INFO - [[12947    17]
 [ 1224   123]]
2022-05-03 11:25:49,479 - INFO - Epoch: 14 | Validation Loss: 20.0417
2022-05-03 11:25:49,481 - INFO - Done epoch 14, spent 0:15:46.759833.
2022-05-03 11:25:49,483 - INFO - Experiment ended. Checkpoints stored =)
2022-05-03 11:25:49,483 - INFO - Experiment ended at 22-05-03_11:25:49, spent 3:57:41.503137.
