2022-04-18 11:15:34,823 - INFO - TempPointConv(
  (relu): ReLU()
  (sigmoid): Sigmoid()
  (hardtanh): Hardtanh(min_val=0.020833333333333332, max_val=100)
  (msle_loss): MSLELoss(
    (squared_error): MSELoss()
  )
  (mse_loss): MSELoss(
    (squared_error): MSELoss()
  )
  (bce_loss): BCELoss()
  (main_dropout): Dropout(p=0.45, inplace=False)
  (temp_dropout): Dropout(p=0.05, inplace=False)
  (empty_module): EmptyModule()
  (diagnosis_encoder): Linear(in_features=293, out_features=64, bias=True)
  (bn_diagnosis_encoder): MyBatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_los): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_mort): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_final_los): Linear(in_features=17, out_features=1, bias=True)
  (point_final_mort): Linear(in_features=17, out_features=1, bias=True)
  (layer_modules): ModuleDict(
    (0): ModuleDict(
      (temp): Conv1d(174, 1044, kernel_size=(4,), stride=(1,), groups=87)
      (bn_temp): MyBatchNorm1d(1044, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=241, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (1): ModuleDict(
      (temp): Conv1d(1300, 1200, kernel_size=(4,), stride=(1,), dilation=(3,), groups=100)
      (bn_temp): MyBatchNorm1d(1200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1298, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ModuleDict(
      (temp): Conv1d(1469, 1356, kernel_size=(4,), stride=(1,), dilation=(6,), groups=113)
      (bn_temp): MyBatchNorm1d(1356, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1454, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (3): ModuleDict(
      (temp): Conv1d(1638, 1512, kernel_size=(4,), stride=(1,), dilation=(9,), groups=126)
      (bn_temp): MyBatchNorm1d(1512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1610, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (4): ModuleDict(
      (temp): Conv1d(1807, 1668, kernel_size=(4,), stride=(1,), dilation=(12,), groups=139)
      (bn_temp): MyBatchNorm1d(1668, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1766, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (5): ModuleDict(
      (temp): Conv1d(1976, 1824, kernel_size=(4,), stride=(1,), dilation=(15,), groups=152)
      (bn_temp): MyBatchNorm1d(1824, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1922, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (6): ModuleDict(
      (temp): Conv1d(2145, 1980, kernel_size=(4,), stride=(1,), dilation=(18,), groups=165)
      (bn_temp): MyBatchNorm1d(1980, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2078, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (7): ModuleDict(
      (temp): Conv1d(2314, 2136, kernel_size=(4,), stride=(1,), dilation=(21,), groups=178)
      (bn_temp): MyBatchNorm1d(2136, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2234, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (8): ModuleDict(
      (temp): Conv1d(2483, 2292, kernel_size=(4,), stride=(1,), dilation=(24,), groups=191)
      (bn_temp): MyBatchNorm1d(2292, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2390, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (point_last_los): Linear(in_features=2781, out_features=17, bias=True)
  (point_last_mort): Linear(in_features=2781, out_features=17, bias=True)
)
2022-04-18 11:15:34,826 - INFO - Config:
2022-04-18 11:15:34,827 - INFO - {
    "L2_regularisation": 0,
    "alpha": 100,
    "base_dir": "models/experiments/final/eICU/LoS/TPC",
    "batch_norm": "mybatchnorm",
    "batch_size": 64,
    "batch_size_test": 32,
    "batchnorm": "mybatchnorm",
    "dataset": "eICU",
    "diagnosis_size": 64,
    "disable_cuda": false,
    "exp_name": "TPC",
    "intermediate_reporting": false,
    "kernel_size": 4,
    "labs_only": false,
    "last_linear_size": 17,
    "learning_rate": 0.00226,
    "loss": "msle",
    "main_dropout_rate": 0.45,
    "mode": "test",
    "model_type": "tpc",
    "n_epochs": 15,
    "n_layers": 9,
    "name": "TPC",
    "no_diag": false,
    "no_exp": false,
    "no_labs": false,
    "no_mask": false,
    "no_skip_connections": false,
    "no_temp_kernels": 12,
    "percentage_data": 100.0,
    "point_size": 13,
    "point_sizes": [
        13,
        13,
        13,
        13,
        13,
        13,
        13,
        13,
        13
    ],
    "save_results_csv": false,
    "seed": 2632763045,
    "share_weights": false,
    "shuffle_train": false,
    "sum_losses": true,
    "task": "LoS",
    "temp_dropout_rate": 0.05,
    "temp_kernels": [
        12,
        12,
        12,
        12,
        12,
        12,
        12,
        12,
        12
    ]
}
2022-04-18 11:15:34,827 - INFO - Experiment started at 22-04-18_11:15:34.
2022-04-18 11:15:34,861 - INFO - validation_epoch_start
2022-04-18 11:15:48,426 - INFO - validation_epoch_end
2022-04-18 11:15:48,562 - INFO - Custom bins confusion matrix:
2022-04-18 11:15:48,563 - INFO - [[208 970  20   2   0   0   0   0   0   0]
 [152 506  14   0   0   0   0   0   0   0]
 [158 352   8   0   0   0   0   0   0   0]
 [148 274   2   0   0   0   0   0   0   0]
 [138 136   0   0   0   0   0   0   0   0]
 [110 132   4   0   0   0   0   0   0   0]
 [102 126  12   0   0   0   0   0   0   0]
 [122 118   0   0   0   0   0   0   0   0]
 [300 502  10   0   0   0   0   0   0   0]
 [ 50 210   0   0   0   0   0   0   0   0]]
2022-04-18 11:15:49,238 - INFO - Epoch: -1 | Validation Loss: 226.3892
2022-04-18 11:15:49,241 - INFO - train_epoch_start
2022-04-18 11:16:27,561 - INFO - validation_epoch_start
2022-04-18 11:17:02,968 - INFO - validation_epoch_end
2022-04-18 11:17:03,770 - INFO - Custom bins confusion matrix:
2022-04-18 11:17:03,770 - INFO - [[   2 5412 1642  526  194  120   66   16   10    0]
 [   6 3038 1022  426  236   94   34   10    6    0]
 [   2 1918  702  256  176   60   26   22   24    0]
 [   0 1244  362  296  128   64   18   18   38    0]
 [   0  586  278  336  174   24    8    4   40    2]
 [   0  386  342  274  118   50   16    8   24   28]
 [   0  408  262  226  110   44   24   10   38   20]
 [   0  418  170  212   90   34   20   12   56    2]
 [   0 1194  842  584  318  180  138   60   36    0]
 [   0  646  490  166   46    4    0    0    0    0]]
2022-04-18 11:17:04,356 - INFO - Epoch: 0 | Validation Loss: 148.5235
2022-04-18 11:17:04,358 - INFO - train_epoch_end
2022-04-18 11:17:04,759 - INFO - Custom bins confusion matrix:
2022-04-18 11:17:04,760 - INFO - [[1234 1897  298  104   46   25   19   13   43   97]
 [ 632 1037  159   50   29    9   16   10   35   72]
 [ 361  713   96   28   25    8    6   11   28   63]
 [ 237  433   52   17   12    6    6    8   38   59]
 [ 207  246   39   27    6   16    8    4   31   46]
 [ 139  169   39   25   19   10    7    5   29   34]
 [  59  150   37   19   12    9    9    3   15   41]
 [  15   78   32    9   13    9    5   11   23   42]
 [ 255  348  101   51   44   33   25   36  104  354]
 [ 630  732  183   94   58   47   45   40  130  191]]
2022-04-18 11:17:05,328 - INFO - Epoch: 0 | Train Loss: 224.1627
2022-04-18 11:17:05,328 - INFO - Done epoch 0, spending 0:01:15.116030.
2022-04-18 11:17:05,328 - INFO - -----------------------------------
2022-04-18 11:17:05,430 - INFO - train_epoch_start
2022-04-18 11:17:43,553 - INFO - validation_epoch_start
2022-04-18 11:18:20,173 - INFO - validation_epoch_end
2022-04-18 11:18:20,940 - INFO - Custom bins confusion matrix:
2022-04-18 11:18:20,941 - INFO - [[ 194 6140 1330  146   74   18   30   36   20    0]
 [ 126 3572  870  210   64   18    6    6    0    0]
 [ 110 2250  596  158   58   10    4    0    0    0]
 [  42 1468  340  182   96   34    6    0    0    0]
 [  32  738  334  196  110   32   10    0    0    0]
 [  38  544  316  150  116   36   32   12    2    0]
 [  30  530  258  144  102   58   10    8    2    0]
 [   0  500  214  128  114   44   10    4    0    0]
 [   0 1652  660  614  200   64   34   50   78    0]
 [   2 1076  152   90   30    2    0    0    0    0]]
2022-04-18 11:18:21,624 - INFO - Epoch: 1 | Validation Loss: 147.5300
2022-04-18 11:18:21,626 - INFO - train_epoch_end
2022-04-18 11:18:22,073 - INFO - Custom bins confusion matrix:
2022-04-18 11:18:22,074 - INFO - [[  76 2740  638  148   80   31   20    9   18   16]
 [  36 1427  368  115   46   18    6    9   14   10]
 [  16  906  285   62   22   10    9    5   15    9]
 [  20  518  192   70   25   10    7    6   10   10]
 [   4  354  161   54   25    7    8    4    7    6]
 [   2  288  107   36   16    9    4    0    6    8]
 [   8  215   54   20   17   11    8    4    9    8]
 [   0   82   60   20   17   12   11    7   18   10]
 [   0  224  231  155  117   88   57   59  191  229]
 [   1  282  243  206  156  147  114  110  349  542]]
2022-04-18 11:18:22,738 - INFO - Epoch: 1 | Train Loss: 137.8315
2022-04-18 11:18:22,739 - INFO - Done epoch 1, spending 0:01:16.195602.
2022-04-18 11:18:22,739 - INFO - -----------------------------------
2022-04-18 11:18:22,790 - INFO - Experiment ended at 22-04-18_11:18:22, spending 0:02:47.963508.
2022-04-18 11:18:22,792 - INFO - Experiment exited. Checkpoints stored =)
