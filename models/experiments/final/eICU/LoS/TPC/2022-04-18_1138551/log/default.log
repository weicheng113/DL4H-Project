2022-04-18 11:38:55,043 - INFO - TempPointConv(
  (relu): ReLU()
  (sigmoid): Sigmoid()
  (hardtanh): Hardtanh(min_val=0.020833333333333332, max_val=100)
  (msle_loss): MSLELoss(
    (squared_error): MSELoss()
  )
  (mse_loss): MSELoss(
    (squared_error): MSELoss()
  )
  (bce_loss): BCELoss()
  (main_dropout): Dropout(p=0.45, inplace=False)
  (temp_dropout): Dropout(p=0.05, inplace=False)
  (empty_module): EmptyModule()
  (diagnosis_encoder): Linear(in_features=293, out_features=64, bias=True)
  (bn_diagnosis_encoder): MyBatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_los): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_mort): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_final_los): Linear(in_features=17, out_features=1, bias=True)
  (point_final_mort): Linear(in_features=17, out_features=1, bias=True)
  (layer_modules): ModuleDict(
    (0): ModuleDict(
      (temp): Conv1d(174, 1044, kernel_size=(4,), stride=(1,), groups=87)
      (bn_temp): MyBatchNorm1d(1044, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=241, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (1): ModuleDict(
      (temp): Conv1d(1300, 1200, kernel_size=(4,), stride=(1,), dilation=(3,), groups=100)
      (bn_temp): MyBatchNorm1d(1200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1298, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ModuleDict(
      (temp): Conv1d(1469, 1356, kernel_size=(4,), stride=(1,), dilation=(6,), groups=113)
      (bn_temp): MyBatchNorm1d(1356, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1454, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (3): ModuleDict(
      (temp): Conv1d(1638, 1512, kernel_size=(4,), stride=(1,), dilation=(9,), groups=126)
      (bn_temp): MyBatchNorm1d(1512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1610, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (4): ModuleDict(
      (temp): Conv1d(1807, 1668, kernel_size=(4,), stride=(1,), dilation=(12,), groups=139)
      (bn_temp): MyBatchNorm1d(1668, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1766, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (5): ModuleDict(
      (temp): Conv1d(1976, 1824, kernel_size=(4,), stride=(1,), dilation=(15,), groups=152)
      (bn_temp): MyBatchNorm1d(1824, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1922, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (6): ModuleDict(
      (temp): Conv1d(2145, 1980, kernel_size=(4,), stride=(1,), dilation=(18,), groups=165)
      (bn_temp): MyBatchNorm1d(1980, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2078, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (7): ModuleDict(
      (temp): Conv1d(2314, 2136, kernel_size=(4,), stride=(1,), dilation=(21,), groups=178)
      (bn_temp): MyBatchNorm1d(2136, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2234, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (8): ModuleDict(
      (temp): Conv1d(2483, 2292, kernel_size=(4,), stride=(1,), dilation=(24,), groups=191)
      (bn_temp): MyBatchNorm1d(2292, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2390, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (point_last_los): Linear(in_features=2781, out_features=17, bias=True)
  (point_last_mort): Linear(in_features=2781, out_features=17, bias=True)
)
2022-04-18 11:38:55,051 - INFO - Config:
2022-04-18 11:38:55,051 - INFO - {
    "L2_regularisation": 0,
    "alpha": 100,
    "base_dir": "models/experiments/final/eICU/LoS/TPC",
    "batch_norm": "mybatchnorm",
    "batch_size": 64,
    "batch_size_test": 32,
    "batchnorm": "mybatchnorm",
    "dataset": "eICU",
    "diagnosis_size": 64,
    "disable_cuda": false,
    "exp_name": "TPC",
    "intermediate_reporting": false,
    "kernel_size": 4,
    "labs_only": false,
    "last_linear_size": 17,
    "learning_rate": 0.00226,
    "loss": "msle",
    "main_dropout_rate": 0.45,
    "mode": "test",
    "model_type": "tpc",
    "n_epochs": 15,
    "n_layers": 9,
    "name": "TPC",
    "no_diag": false,
    "no_exp": false,
    "no_labs": false,
    "no_mask": false,
    "no_skip_connections": false,
    "no_temp_kernels": 12,
    "percentage_data": 100.0,
    "point_size": 13,
    "point_sizes": [
        13,
        13,
        13,
        13,
        13,
        13,
        13,
        13,
        13
    ],
    "save_results_csv": false,
    "seed": 488331071,
    "share_weights": false,
    "shuffle_train": false,
    "sum_losses": true,
    "task": "LoS",
    "temp_dropout_rate": 0.05,
    "temp_kernels": [
        12,
        12,
        12,
        12,
        12,
        12,
        12,
        12,
        12
    ]
}
2022-04-18 11:38:55,052 - INFO - Experiment started at 22-04-18_11:38:55.
2022-04-18 11:38:55,081 - INFO - validation_epoch_start
2022-04-18 11:39:08,514 - INFO - validation_epoch_end
2022-04-18 11:39:08,514 - INFO - Sanity Checking | Validation Loss: 191.4520
2022-04-18 11:39:08,516 - INFO - train_epoch_start
2022-04-18 11:39:51,770 - INFO - validation_epoch_start
2022-04-18 11:40:27,146 - INFO - validation_epoch_end
2022-04-18 11:40:27,935 - INFO - Custom bins confusion matrix:
2022-04-18 11:40:27,937 - INFO - [[   6 7182  276  176  126   80   50   20   22   50]
 [   8 4126  276  214   92   46   14   12   34   50]
 [  18 2544  310  138   52   14   14    4   28   64]
 [  20 1584  310  130   22    6    0    2   22   72]
 [   2  970  238  102   32   14    0    6   48   40]
 [   0  842  122  116   54   26   30    4   32   20]
 [   0  732  168   74   74   18    8   12   48    8]
 [   0  700  118   80   48   32   24   10    2    0]
 [   4 2502  424  160   90   72   64   24   12    0]
 [   0  984  292   74    2    0    0    0    0    0]]
2022-04-18 11:40:28,772 - INFO - Epoch: 0 | Validation Loss: 161.0655
2022-04-18 11:40:28,774 - INFO - train_epoch_end
2022-04-18 11:40:29,201 - INFO - Custom bins confusion matrix:
2022-04-18 11:40:29,202 - INFO - [[1268 1869  280   81   40   28   21    9   42  138]
 [ 647  982  181   61   20   13   10   10   31   94]
 [ 351  710  108   27   11    8   10    8   26   80]
 [ 199  467   59   17   14    8   10    5   26   63]
 [ 191  284   23   28   10    8    7    4   20   55]
 [ 152  178   31   11   13    6   12    3   18   52]
 [  55  158   36    8    8    5    6    7   21   50]
 [  28   68   18   11   13    9    5   10   18   57]
 [ 218  300  109   72   39   27   28   19   75  464]
 [ 428  736  237  115   69   48   44   25  122  326]]
2022-04-18 11:40:29,778 - INFO - Epoch: 0 | Train Loss: 222.1109
2022-04-18 11:40:29,778 - INFO - Done epoch 0, spending 0:01:20.257341.
2022-04-18 11:40:29,778 - INFO - -----------------------------------
2022-04-18 11:40:29,884 - INFO - train_epoch_start
2022-04-18 11:41:08,169 - INFO - validation_epoch_start
2022-04-18 11:41:42,888 - INFO - validation_epoch_end
2022-04-18 11:41:43,696 - INFO - Custom bins confusion matrix:
2022-04-18 11:41:43,696 - INFO - [[  34 5766 1106  412  186   92   82   58  198   54]
 [  24 3380  762  314  172   86   30   28   54   22]
 [   8 2328  468  100   52   84   64   40   42    0]
 [   6 1436  238  172   90   44   58   20   72   32]
 [  10  742  164  140   94   88   84   26   92   12]
 [  14  486  290  136   94   66   60   40   48   12]
 [   6  576  192  142   70   40   28   36   46    6]
 [   0  550  180  106   40   28   40   26   44    0]
 [  96 1528  398  486  256  150  154   84  126   74]
 [   0  954  248   24   20   60   36   10    0    0]]
2022-04-18 11:41:44,385 - INFO - Epoch: 1 | Validation Loss: 162.6651
2022-04-18 11:41:44,386 - INFO - train_epoch_end
2022-04-18 11:41:44,795 - INFO - Custom bins confusion matrix:
2022-04-18 11:41:44,795 - INFO - [[ 648 2744  270   54   25   17    6    4    5    3]
 [ 331 1499  174   24   12    4    1    0    4    0]
 [ 211  985  107   19    3    9    2    1    2    0]
 [ 117  615   80   28   13    6    5    0    4    0]
 [  71  451   65   19    9    7    0    3    3    2]
 [  70  333   54    6    5    3    1    0    3    1]
 [  50  234   37   13    3    6    4    1    5    1]
 [  18  109   42   15    8    5    5    2   11   22]
 [  27  419  202  103   70   41   32   22  105  330]
 [  37  464  326  185  115   85   63   56  215  604]]
2022-04-18 11:41:45,534 - INFO - Epoch: 1 | Train Loss: 148.5318
2022-04-18 11:41:45,535 - INFO - Done epoch 1, spending 0:01:14.502576.
2022-04-18 11:41:45,535 - INFO - -----------------------------------
2022-04-18 11:41:45,587 - INFO - Experiment ended at 22-04-18_11:41:45, spending 0:02:50.535262.
2022-04-18 11:41:45,589 - INFO - Experiment exited. Checkpoints stored =)
