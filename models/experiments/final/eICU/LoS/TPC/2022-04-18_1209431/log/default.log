2022-04-18 12:09:43,231 - INFO - TempPointConv(
  (relu): ReLU()
  (sigmoid): Sigmoid()
  (hardtanh): Hardtanh(min_val=0.020833333333333332, max_val=100)
  (msle_loss): MSLELoss(
    (squared_error): MSELoss()
  )
  (mse_loss): MSELoss(
    (squared_error): MSELoss()
  )
  (bce_loss): BCELoss()
  (main_dropout): Dropout(p=0.45, inplace=False)
  (temp_dropout): Dropout(p=0.05, inplace=False)
  (empty_module): EmptyModule()
  (diagnosis_encoder): Linear(in_features=293, out_features=64, bias=True)
  (bn_diagnosis_encoder): MyBatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_los): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_mort): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_final_los): Linear(in_features=17, out_features=1, bias=True)
  (point_final_mort): Linear(in_features=17, out_features=1, bias=True)
  (layer_modules): ModuleDict(
    (0): ModuleDict(
      (temp): Conv1d(174, 1044, kernel_size=(4,), stride=(1,), groups=87)
      (bn_temp): MyBatchNorm1d(1044, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=241, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (1): ModuleDict(
      (temp): Conv1d(1300, 1200, kernel_size=(4,), stride=(1,), dilation=(3,), groups=100)
      (bn_temp): MyBatchNorm1d(1200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1298, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ModuleDict(
      (temp): Conv1d(1469, 1356, kernel_size=(4,), stride=(1,), dilation=(6,), groups=113)
      (bn_temp): MyBatchNorm1d(1356, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1454, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (3): ModuleDict(
      (temp): Conv1d(1638, 1512, kernel_size=(4,), stride=(1,), dilation=(9,), groups=126)
      (bn_temp): MyBatchNorm1d(1512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1610, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (4): ModuleDict(
      (temp): Conv1d(1807, 1668, kernel_size=(4,), stride=(1,), dilation=(12,), groups=139)
      (bn_temp): MyBatchNorm1d(1668, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1766, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (5): ModuleDict(
      (temp): Conv1d(1976, 1824, kernel_size=(4,), stride=(1,), dilation=(15,), groups=152)
      (bn_temp): MyBatchNorm1d(1824, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1922, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (6): ModuleDict(
      (temp): Conv1d(2145, 1980, kernel_size=(4,), stride=(1,), dilation=(18,), groups=165)
      (bn_temp): MyBatchNorm1d(1980, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2078, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (7): ModuleDict(
      (temp): Conv1d(2314, 2136, kernel_size=(4,), stride=(1,), dilation=(21,), groups=178)
      (bn_temp): MyBatchNorm1d(2136, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2234, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (8): ModuleDict(
      (temp): Conv1d(2483, 2292, kernel_size=(4,), stride=(1,), dilation=(24,), groups=191)
      (bn_temp): MyBatchNorm1d(2292, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2390, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (point_last_los): Linear(in_features=2781, out_features=17, bias=True)
  (point_last_mort): Linear(in_features=2781, out_features=17, bias=True)
)
2022-04-18 12:09:43,244 - INFO - Config:
2022-04-18 12:09:43,246 - INFO - {
    "L2_regularisation": 0,
    "alpha": 100,
    "base_dir": "models/experiments/final/eICU/LoS/TPC",
    "batch_norm": "mybatchnorm",
    "batch_size": 64,
    "batch_size_test": 32,
    "batchnorm": "mybatchnorm",
    "dataset": "eICU",
    "diagnosis_size": 64,
    "disable_cuda": false,
    "exp_name": "TPC",
    "intermediate_reporting": false,
    "kernel_size": 4,
    "labs_only": false,
    "last_linear_size": 17,
    "learning_rate": 0.00226,
    "loss": "msle",
    "main_dropout_rate": 0.45,
    "mode": "test",
    "model_type": "tpc",
    "n_epochs": 15,
    "n_layers": 9,
    "name": "TPC",
    "no_diag": false,
    "no_exp": false,
    "no_labs": false,
    "no_mask": false,
    "no_skip_connections": false,
    "no_temp_kernels": 12,
    "percentage_data": 100.0,
    "point_size": 13,
    "point_sizes": [
        13,
        13,
        13,
        13,
        13,
        13,
        13,
        13,
        13
    ],
    "save_results_csv": false,
    "seed": 1947354815,
    "share_weights": false,
    "shuffle_train": false,
    "sum_losses": true,
    "task": "LoS",
    "temp_dropout_rate": 0.05,
    "temp_kernels": [
        12,
        12,
        12,
        12,
        12,
        12,
        12,
        12,
        12
    ]
}
2022-04-18 12:09:43,247 - INFO - Experiment started at 22-04-18_12:09:43.
2022-04-18 12:09:43,288 - INFO - validation_epoch_start
2022-04-18 12:09:56,997 - INFO - validation_epoch_end
2022-04-18 12:09:56,997 - INFO - Sanity Checking | Validation Loss: 200.6380
2022-04-18 12:09:57,000 - INFO - train_epoch_start
2022-04-18 12:13:20,565 - INFO - validation_epoch_start
2022-04-18 12:15:38,344 - INFO - validation_epoch_end
2022-04-18 12:15:41,641 - INFO - Custom bins confusion matrix:
2022-04-18 12:15:41,644 - INFO - [[ 2944 33932  3576   856   416   174    10     0     0     0]
 [ 1314 19520  2446   838   280    66    34     2     0     0]
 [  890 11190  1872   840   252    48    10     2     0     0]
 [  310  6816  1676   566   194    74    18     8    24     0]
 [  142  4304  1390   330   230    58    36    30    58     0]
 [  106  3422  1016   312   128   102    52    56    14     0]
 [   90  2692   804   264   224   110    18     6     0     0]
 [   58  2348   682   328    82    42     0     0     0     0]
 [    0  6220  2718  1124   546   126    58    60    18     0]
 [    0  3574   924   712   628   440   118    16     0     0]]
2022-04-18 12:15:42,756 - INFO - Epoch: 0 | Validation Loss: 122.3156
2022-04-18 12:15:42,757 - INFO - train_epoch_end
2022-04-18 12:15:44,569 - INFO - Custom bins confusion matrix:
2022-04-18 12:15:44,569 - INFO - [[ 4837 13228  1447   479   252   131    76    64   148   231]
 [ 2657  7662  1008   327   159    78    45    36   107   192]
 [ 1528  4854   701   232   115    50    48    27    83   162]
 [  996  3314   571   166    91    51    36    25    72   127]
 [  736  2317   454   153    82    53    32    20    57    97]
 [  584  1765   374   133    77    44    30    16    41    91]
 [  384  1283   288    99    64    35    27     8    50    87]
 [  237   940   227    88    45    25    17    18    51    94]
 [  921  2629   716   302   176    92    57    51   142   619]
 [  804  2118   627   287   159    92    63    49   159   452]]
2022-04-18 12:15:45,215 - INFO - Epoch: 0 | Train Loss: 163.0206
2022-04-18 12:15:45,215 - INFO - Done epoch 0, spending 0:05:45.756804.
2022-04-18 12:15:45,215 - INFO - -----------------------------------
2022-04-18 12:15:45,276 - INFO - train_epoch_start
2022-04-18 12:19:04,665 - INFO - validation_epoch_start
2022-04-18 12:21:24,498 - INFO - validation_epoch_end
2022-04-18 12:21:27,560 - INFO - Custom bins confusion matrix:
2022-04-18 12:21:27,560 - INFO - [[18730 20390  2124   522    82    24    14    10    12     0]
 [ 8098 13676  2228   386    80    32     0     0     0     0]
 [ 3812  9110  1676   368    86    34    18     0     0     0]
 [ 1806  6102  1234   416    94    32     2     0     0     0]
 [  880  4158  1068   358    94    20     0     0     0     0]
 [  840  3010   956   320    52    18     4     4     4     0]
 [  530  2524   718   290    68    12     6    16    42     2]
 [  406  2328   430   214    44    36    34    20    28     0]
 [  556  6684  2392   814   312    90    18     2     2     0]
 [  644  2928  1828   580   290    68    50    14    10     0]]
2022-04-18 12:21:28,320 - INFO - Epoch: 1 | Validation Loss: 121.0119
2022-04-18 12:21:28,322 - INFO - train_epoch_end
2022-04-18 12:21:30,220 - INFO - Custom bins confusion matrix:
2022-04-18 12:21:30,220 - INFO - [[ 4661 13799  1358   429   210   136    73    47   126    54]
 [ 2047  8213  1061   353   199   104    62    54   123    55]
 [  980  5052   898   308   155    91    70    51   113    82]
 [  569  3392   674   287   150    88    73    36   110    70]
 [  330  2458   516   237   134    77    49    29   113    58]
 [  273  1817   449   217   100    68    44    37    93    57]
 [  175  1237   393   187    75    64    27    30    76    61]
 [  102   838   303   185    99    51    31    23    66    44]
 [  219  2344  1047   483   336   213   159   116   410   378]
 [   75  1437   782   490   344   253   181   140   548   560]]
2022-04-18 12:21:31,177 - INFO - Epoch: 1 | Train Loss: 129.4792
2022-04-18 12:21:31,177 - INFO - Done epoch 1, spending 0:05:43.046008.
2022-04-18 12:21:31,177 - INFO - -----------------------------------
2022-04-18 12:21:31,231 - INFO - train_epoch_start
2022-04-18 12:24:49,660 - INFO - validation_epoch_start
