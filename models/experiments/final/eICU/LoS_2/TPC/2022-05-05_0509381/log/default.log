2022-05-05 05:09:38,856 - INFO - Config:
2022-05-05 05:09:38,857 - INFO - {
    "L2_regularisation": 0,
    "alpha": 100,
    "base_dir": "models/experiments/final/eICU/LoS_2/TPC",
    "batch_norm": "mybatchnorm",
    "batch_size": 32,
    "batch_size_test": 32,
    "batchnorm": "mybatchnorm",
    "dataset": "eICU",
    "diagnosis_size": 64,
    "disable_cuda": false,
    "exp_name": "TPC",
    "intermediate_reporting": false,
    "kernel_size": 4,
    "labs_only": false,
    "last_linear_size": 17,
    "learning_rate": 0.00226,
    "loss": "msle",
    "main_dropout_rate": 0.45,
    "mode": "train",
    "model_type": "tpc",
    "n_epochs": 15,
    "n_layers": 9,
    "name": "TPC",
    "no_diag": false,
    "no_exp": false,
    "no_labs": false,
    "no_mask": false,
    "no_skip_connections": false,
    "no_temp_kernels": 12,
    "percentage_data": 100.0,
    "point_size": 13,
    "point_sizes": [
        13,
        13,
        13,
        13,
        13,
        13,
        13,
        13,
        13
    ],
    "save_results_csv": false,
    "seed": 3335482042,
    "share_weights": false,
    "shuffle_train": true,
    "sum_losses": true,
    "task": "LoS",
    "temp_dropout_rate": 0.05,
    "temp_kernels": [
        12,
        12,
        12,
        12,
        12,
        12,
        12,
        12,
        12
    ]
}
2022-05-05 05:09:45,894 - INFO - Experiment set up.
2022-05-05 05:09:49,451 - INFO - TempPointConv2(
  (relu): ReLU()
  (sigmoid): Sigmoid()
  (hardtanh): Hardtanh(min_val=0.020833333333333332, max_val=100)
  (msle_loss): MSLELoss(
    (squared_error): MSELoss()
  )
  (mse_loss): MSELoss(
    (squared_error): MSELoss()
  )
  (bce_loss): BCELoss()
  (main_dropout): Dropout(p=0.45, inplace=False)
  (temp_dropout): Dropout(p=0.05, inplace=False)
  (empty_module): EmptyModule()
  (diagnosis_encoder): Linear(in_features=293, out_features=64, bias=True)
  (bn_diagnosis_encoder): MyBatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_los): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_mort): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_final_los): Linear(in_features=17, out_features=1, bias=True)
  (point_final_mort): Linear(in_features=17, out_features=1, bias=True)
  (layer_modules): ModuleDict(
    (0): ModuleDict(
      (temp): Conv1d(174, 1044, kernel_size=(4,), stride=(1,), groups=87)
      (bn_temp): MyBatchNorm1d(1044, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=241, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (1): ModuleDict(
      (temp): Conv1d(1400, 1200, kernel_size=(4,), stride=(1,), dilation=(3,), groups=100)
      (bn_temp): MyBatchNorm1d(1200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1298, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ModuleDict(
      (temp): Conv1d(1582, 1356, kernel_size=(4,), stride=(1,), dilation=(6,), groups=113)
      (bn_temp): MyBatchNorm1d(1356, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1454, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (3): ModuleDict(
      (temp): Conv1d(1764, 1512, kernel_size=(4,), stride=(1,), dilation=(9,), groups=126)
      (bn_temp): MyBatchNorm1d(1512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1610, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (4): ModuleDict(
      (temp): Conv1d(1946, 1668, kernel_size=(4,), stride=(1,), dilation=(12,), groups=139)
      (bn_temp): MyBatchNorm1d(1668, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1766, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (5): ModuleDict(
      (temp): Conv1d(2128, 1824, kernel_size=(4,), stride=(1,), dilation=(15,), groups=152)
      (bn_temp): MyBatchNorm1d(1824, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=1922, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (6): ModuleDict(
      (temp): Conv1d(2310, 1980, kernel_size=(4,), stride=(1,), dilation=(18,), groups=165)
      (bn_temp): MyBatchNorm1d(1980, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2078, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (7): ModuleDict(
      (temp): Conv1d(2492, 2136, kernel_size=(4,), stride=(1,), dilation=(21,), groups=178)
      (bn_temp): MyBatchNorm1d(2136, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2234, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (8): ModuleDict(
      (temp): Conv1d(2674, 2292, kernel_size=(4,), stride=(1,), dilation=(24,), groups=191)
      (bn_temp): MyBatchNorm1d(2292, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (point): Linear(in_features=2390, out_features=13, bias=True)
      (bn_point): MyBatchNorm1d(13, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (point_last_los): Linear(in_features=2985, out_features=17, bias=True)
  (point_last_mort): Linear(in_features=2985, out_features=17, bias=True)
)
2022-05-05 05:09:49,453 - INFO - number of parameters: 1151428
2022-05-05 05:09:49,453 - INFO - Experiment started at 22-05-05_05:09:49.
2022-05-05 05:23:29,860 - INFO - Train Metrics:
2022-05-05 05:23:29,863 - INFO - ==> Length of Stay:
2022-05-05 05:24:02,626 - INFO - Custom bins confusion matrix:
2022-05-05 05:24:02,627 - INFO - [[1219230  660375  139469   43885   18010    8502    4621    2733    4547
     1095]
 [ 407338  521466  181197   64949   27979   13920    7448    4414    7719
     1675]
 [ 134942  300355  171995   72487   34091   17619    9796    5822   10326
     2347]
 [  54834  164116  131986   68092   34775   18777   11128    6898   12460
     2814]
 [  27750   95141   93363   57330   32420   18218   11078    7004   13491
     3394]
 [  15522   60066   66785   45856   27889   16888   10383    6867   13770
     3980]
 [   9453   40645   48910   35878   23381   14953    9554    6554   13863
     4201]
 [   5771   28610   36345   28374   19446   12923    8585    6206   13103
     4330]
 [  13564   76141  101044   87685   64411   45775   32389   23103   55733
    21693]
 [   6369   39536   58741   55125   42713   31255   22921   17158   43120
    19725]]
2022-05-05 05:24:10,011 - INFO - Mean absolute deviation (MAD) = 2.5853688230142833
2022-05-05 05:24:10,011 - INFO - Mean squared error (MSE) = 33.70579900620013
2022-05-05 05:24:10,011 - INFO - Mean absolute percentage error (MAPE) = 113.06908878315198
2022-05-05 05:24:10,011 - INFO - Mean squared logarithmic error (MSLE) = 1.3344539799650363
2022-05-05 05:24:10,011 - INFO - R^2 Score = 0.08073150129602935
2022-05-05 05:24:10,011 - INFO - Cohen kappa score = 0.3805889722537026
2022-05-05 05:24:10,795 - INFO - Epoch: 0 | Train Loss: 83.9583
2022-05-05 05:25:55,852 - INFO - Validation Metrics:
2022-05-05 05:25:55,852 - INFO - ==> Length of Stay:
2022-05-05 05:26:02,789 - INFO - Custom bins confusion matrix:
2022-05-05 05:26:02,790 - INFO - [[313619  99170  26141   7546   2267    602    196     48     15      0]
 [ 80034 116247  45082  15179   4671   1284    392     81     26      0]
 [ 13185  58183  53860  23882   8337   2663    871    205     29      0]
 [  3884  21297  36856  26139  12266   4364   1269    421    147      0]
 [  1537   9276  19725  22851  12820   5988   2202    671    327      1]
 [   899   4655  12050  16124  12509   6348   2714   1013    680     12]
 [   506   2751   6675  10882  10745   6532   2934   1292   1011      2]
 [   346   1946   4266   7674   8116   6223   3220   1484   1292      0]
 [  1101   3819   9328  18810  25060  22340  14939   8604   6971     48]
 [   664   2236   4427   8791  14725  16117  11426   7403   5836     56]]
2022-05-05 05:26:04,225 - INFO - Mean absolute deviation (MAD) = 2.206190069037846
2022-05-05 05:26:04,225 - INFO - Mean squared error (MSE) = 54.15271762864583
2022-05-05 05:26:04,225 - INFO - Mean absolute percentage error (MAPE) = 80.80875594591555
2022-05-05 05:26:04,225 - INFO - Mean squared logarithmic error (MSLE) = 0.8837498376002378
2022-05-05 05:26:04,225 - INFO - R^2 Score = 0.12283429025901738
2022-05-05 05:26:04,225 - INFO - Cohen kappa score = 0.5160724664394667
2022-05-05 05:26:04,749 - INFO - Epoch: 0 | Validation Loss: 55.1323
2022-05-05 05:26:04,752 - INFO - Done epoch 0, spent 0:16:15.299079.
2022-05-05 05:26:29,926 - INFO - Experiment exited. Checkpoints stored =)
